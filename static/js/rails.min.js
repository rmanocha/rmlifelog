
n(a,b){var c;a.rails=c={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not(button[type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input:file",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(b){var c=a('meta[name="csrf-token"]').attr("content");if(c)b.setRequestHeader("X-CSRF-Token",c)},fire:function(b,c,d){var e=a.Event(c);b.trigger(e,d);return e.result!==false},confirm:function(a){return confirm(a)},ajax:function(b){return a.ajax(b)},href:function(a){return a.attr("href")},handleRemote:function(d){var e,f,g,h=d.data("cross-domain")||null,i=d.data("type")||a.ajaxSettings&&a.ajaxSettings.dataType,j;if(c.fire(d,"ajax:before")){if(d.is("form")){e=d.attr("method");f=d.attr("action");g=d.serializeArray();var k=d.data("ujs:submit-button");if(k){g.push(k);d.data("ujs:submit-button",null)}}else if(d.is(c.inputChangeSelector)){e=d.data("method");f=d.data("url");g=d.serialize();if(d.data("params"))g=g+"&"+d.data("params")}else{e=d.data("method");f=c.href(d);g=d.data("params")||null}j={type:e||"GET",data:g,dataType:i,crossDomain:h,beforeSend:function(a,e){if(e.dataType===b){a.setRequestHeader("accept","*/*;q=0.5, "+e.accepts.script)}return c.fire(d,"ajax:beforeSend",[a,e])},success:function(a,b,c){d.trigger("ajax:success",[a,b,c])},complete:function(a,b){d.trigger("ajax:complete",[a,b])},error:function(a,b,c){d.trigger("ajax:error",[a,b,c])}};if(f){j.url=f}return c.ajax(j)}else{return false}},handleMethod:function(d){var e=c.href(d),f=d.data("method"),g=d.attr("target"),h=a("meta[name=csrf-token]").attr("content"),i=a("meta[name=csrf-param]").attr("content"),j=a('<form method="post" action="'+e+'"></form>'),k='<input name="_method" value="'+f+'" type="hidden" />';if(i!==b&&h!==b){k+='<input name="'+i+'" value="'+h+'" type="hidden" />'}if(g){j.attr("target",g)}j.hide().append(k).appendTo("body");j.submit()},disableFormElements:function(b){b.find(c.disableSelector).each(function(){var b=a(this),c=b.is("button")?"html":"val";b.data("ujs:enable-with",b[c]());b[c](b.data("disable-with"));b.prop("disabled",true)})},enableFormElements:function(b){b.find(c.enableSelector).each(function(){var b=a(this),c=b.is("button")?"html":"val";if(b.data("ujs:enable-with"))b[c](b.data("ujs:enable-with"));b.prop("disabled",false)})},allowAction:function(a){var b=a.data("confirm"),d=false,e;if(!b){return true}if(c.fire(a,"confirm")){d=c.confirm(b);e=c.fire(a,"confirm:complete",[d])}return d&&e},blankInputs:function(b,c,d){var e=a(),f,g=c||"input,textarea";b.find(g).each(function(){f=a(this);if(d?f.val():!f.val()){e=e.add(f)}});return e.length?e:false},nonBlankInputs:function(a,b){return c.blankInputs(a,b,true)},stopEverything:function(b){a(b.target).trigger("ujs:everythingStopped");b.stopImmediatePropagation();return false},callFormSubmitBindings:function(c,d){var e=c.data("events"),f=true;if(e!==b&&e["submit"]!==b){a.each(e["submit"],function(a,b){if(typeof b.handler==="function")return f=b.handler(d)})}return f},disableElement:function(a){a.data("ujs:enable-with",a.html());a.html(a.data("disable-with"));a.bind("click.railsDisable",function(a){return c.stopEverything(a)})},enableElement:function(a){if(a.data("ujs:enable-with")!==b){a.html(a.data("ujs:enable-with"));a.data("ujs:enable-with",false)}a.unbind("click.railsDisable")}};a.ajaxPrefilter(function(a,b,d){if(!a.crossDomain){c.CSRFProtection(d)}});a(document).delegate(c.linkDisableSelector,"ajax:complete",function(){c.enableElement(a(this))});a(document).delegate(c.linkClickSelector,"click.rails",function(d){var e=a(this),f=e.data("method"),g=e.data("params");if(!c.allowAction(e))return c.stopEverything(d);if(e.is(c.linkDisableSelector))c.disableElement(e);if(e.data("remote")!==b){if((d.metaKey||d.ctrlKey)&&(!f||f==="GET")&&!g){return true}if(c.handleRemote(e)===false){c.enableElement(e)}return false}else if(e.data("method")){c.handleMethod(e);return false}});a(document).delegate(c.inputChangeSelector,"change.rails",function(b){var d=a(this);if(!c.allowAction(d))return c.stopEverything(b);c.handleRemote(d);return false});a(document).delegate(c.formSubmitSelector,"submit.rails",function(d){var e=a(this),f=e.data("remote")!==b,g=c.blankInputs(e,c.requiredInputSelector),h=c.nonBlankInputs(e,c.fileInputSelector);if(!c.allowAction(e))return c.stopEverything(d);if(g&&e.attr("novalidate")==b&&c.fire(e,"ajax:aborted:required",[g])){return c.stopEverything(d)}if(f){if(h){return c.fire(e,"ajax:aborted:file",[h])}if(!a.support.submitBubbles&&a().jquery<"1.7"&&c.callFormSubmitBindings(e,d)===false)return c.stopEverything(d);c.handleRemote(e);return false}else{setTimeout(function(){c.disableFormElements(e)},13)}});a(document).delegate(c.formInputClickSelector,"click.rails",function(b){var d=a(this);if(!c.allowAction(d))return c.stopEverything(b);var e=d.attr("name"),f=e?{name:e,value:d.val()}:null;d.closest("form").data("ujs:submit-button",f)});a(document).delegate(c.formSubmitSelector,"ajax:beforeSend.rails",function(b){if(this==b.target)c.disableFormElements(a(this))});a(document).delegate(c.formSubmitSelector,"ajax:complete.rails",function(b){if(this==b.target)c.enableFormElements(a(this))})})(jQuery)
